<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My GitHub Projects</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { font-family: Arial, sans-serif; transition: 0.3s; }
    .dark-mode { background-color: #121212; color: #fff; }
    .repo-card { transition: transform 0.3s; }
    .repo-card:hover { transform: translateY(-5px); }
    .btn-gradient { background: linear-gradient(45deg,#0d6efd,#6610f2); color: #fff; border: none; }
    .btn-gradient:hover { opacity: 0.9; }
    .back-to-top { position: fixed; bottom: 30px; right: 30px; display: none; z-index: 1000; }
    .skeleton { background: #e0e0e0; height: 100px; border-radius: 5px; margin-bottom: 20px; }
    .dark-mode .card { background-color: #1e1e1e; color: #fff; }
    .dark-mode .btn-gradient { color: #fff; }
    .badge-lang { margin-right: 5px; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm mb-4">
    <div class="container">
      <a class="navbar-brand" href="#">My GitHub Projects</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="profile.html">Me</a>
          </li>
          <li class="nav-item">
            <button id="toggleDark" class="btn btn-outline-dark ms-3">Dark Mode</button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <h1 class="text-center mb-4">My GitHub Projects</h1>
    <div class="row mb-4">
      <div class="col-md-4">
        <input type="text" id="searchInput" class="form-control" placeholder="Search repositories...">
      </div>
      <div class="col-md-4">
        <select id="languageFilter" class="form-select">
          <option value="">All Languages</option>
        </select>
      </div>
      <div class="col-md-4">
        <select id="sortFilter" class="form-select">
          <option value="updated">Sort by Updated</option>
          <option value="stars">Sort by Stars</option>
          <option value="forks">Sort by Forks</option>
          <option value="name">Sort by Name</option>
        </select>
      </div>
    </div>

    <div class="row" id="repo-list">
      <!-- Skeleton loaders initially -->
      <div class="col-md-4"><div class="skeleton"></div></div>
      <div class="col-md-4"><div class="skeleton"></div></div>
      <div class="col-md-4"><div class="skeleton"></div></div>
    </div>
  </div>

  <button class="btn btn-primary back-to-top" id="backToTop"><i class="bi bi-arrow-up"></i></button>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const username = "thingumicu";  
    const repoList = document.getElementById("repo-list");
    const searchInput = document.getElementById("searchInput");
    const languageFilter = document.getElementById("languageFilter");
    const sortFilter = document.getElementById("sortFilter");
    const backToTop = document.getElementById("backToTop");
    const toggleDark = document.getElementById("toggleDark");

    let allRepos = [];

    toggleDark.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
    });

    fetch(`https://api.github.com/users/${username}/repos`)
      .then(response => response.json())
      .then(data => {
        allRepos = data;
        populateLanguages(allRepos);
        displayRepos(allRepos);
      })
      .catch(err => {
        console.error(err);
        repoList.innerHTML = "<p class='text-center'>Failed to load repositories.</p>";
      });

    function populateLanguages(repos) {
      const languages = [...new Set(repos.map(r => r.language).filter(Boolean))];
      languages.forEach(lang => {
        const option = document.createElement("option");
        option.value = lang;
        option.textContent = lang;
        languageFilter.appendChild(option);
      });
    }

    function getLangBadge(lang) {
      const colors = {
        "HTML": "danger",
        "CSS": "primary",
        "JavaScript": "warning text-dark",
        "PHP": "secondary",
        "C#": "info text-dark",
        "Python": "success",
        "default": "dark"
      };
      const colorClass = colors[lang] || colors["default"];
      return `<span class="badge bg-${colorClass} badge-lang">${lang}</span>`;
    }

    function displayRepos(repos) {
      repoList.innerHTML = "";
      repos.forEach(repo => {
        const col = document.createElement("div");
        col.className = "col-md-4 mb-4";
        const card = document.createElement("div");
        card.className = "card repo-card shadow-sm h-100";
        card.innerHTML = `
          <div class="card-body d-flex flex-column">
            <h5 class="card-title"><i class="bi bi-folder2 me-2 text-primary"></i>${repo.name}</h5>
            <p class="card-text text-muted">${repo.description || "No description available."}</p>
            <p>
              ${getLangBadge(repo.language)}
              <span class="badge bg-success">‚≠ê ${repo.stargazers_count}</span>
              <span class="badge bg-info text-dark">üç¥ ${repo.forks_count}</span>
              <span class="badge bg-secondary">üëÄ ${repo.watchers_count}</span>
            </p>
            <p class="text-muted" style="font-size: 0.85rem;">Updated: ${new Date(repo.updated_at).toLocaleDateString()}</p>
            <div class="mt-auto">
              <a href="${repo.html_url}" target="_blank" class="btn btn-gradient w-100">View on GitHub</a>
            </div>
          </div>`;
        col.appendChild(card);
        repoList.appendChild(col);
      });
    }

    function filterRepos() {
      let filtered = allRepos.filter(r => r.name.toLowerCase().includes(searchInput.value.toLowerCase()));
      if (languageFilter.value) filtered = filtered.filter(r => r.language === languageFilter.value);
      if (sortFilter.value === "stars") filtered.sort((a,b) => b.stargazers_count - a.stargazers_count);
      else if (sortFilter.value === "forks") filtered.sort((a,b) => b.forks_count - a.forks_count);
      else if (sortFilter.value === "name") filtered.sort((a,b) => a.name.localeCompare(b.name));
      else filtered.sort((a,b) => new Date(b.updated_at) - new Date(a.updated_at));
      displayRepos(filtered);
    }

    searchInput.addEventListener("input", filterRepos);
    languageFilter.addEventListener("change", filterRepos);
    sortFilter.addEventListener("change", filterRepos);

    window.addEventListener("scroll", () => {
      backToTop.style.display = window.scrollY > 300 ? "block" : "none";
    });
    backToTop.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  </script>
</body>
</html>
